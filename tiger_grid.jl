include("project_1.jl")
include("project_2.jl")

n_s = 36; n_a = 5; n_o = 17;

T = zeros(Float64,n_s,n_a,n_s)
O = zeros(Float64,n_s,n_a,n_o)
R = zeros(Float64,n_s,n_a,n_s)

T[1,1,1]=1.0
T[1,2,6]=0.05
T[1,2,21]=0.025
T[1,2,23]=0.025
T[1,2,1]=0.9
T[1,3,1]=0.1
T[1,3,2]=0.7
T[1,3,3]=0.1
T[1,3,4]=0.1
T[1,4,1]=0.1
T[1,4,2]=0.15
T[1,4,3]=0.6
T[1,4,4]=0.15
T[1,5,1]=0.1
T[1,5,2]=0.1
T[1,5,3]=0.1
T[1,5,4]=0.7
T[2,1,2]=1.0
T[2,2,6]=0.8
T[2,2,23]=0.05
T[2,2,2]=0.15
T[2,3,1]=0.1
T[2,3,2]=0.1
T[2,3,3]=0.7
T[2,3,4]=0.1
T[2,4,1]=0.15
T[2,4,2]=0.1
T[2,4,3]=0.15
T[2,4,4]=0.6
T[2,5,1]=0.7
T[2,5,2]=0.1
T[2,5,3]=0.1
T[2,5,4]=0.1
T[3,1,3]=1.0
T[3,2,6]=0.05
T[3,2,23]=0.8
T[3,2,3]=0.15
T[3,3,1]=0.1
T[3,3,2]=0.1
T[3,3,3]=0.1
T[3,3,4]=0.7
T[3,4,1]=0.6
T[3,4,2]=0.15
T[3,4,3]=0.1
T[3,4,4]=0.15
T[3,5,1]=0.1
T[3,5,2]=0.7
T[3,5,3]=0.1
T[3,5,4]=0.1
T[4,1,4]=1.0
T[4,2,6]=0.025
T[4,2,8]=0.025
T[4,2,23]=0.05
T[4,2,4]=0.9
T[4,3,1]=0.7
T[4,3,2]=0.1
T[4,3,3]=0.1
T[4,3,4]=0.1
T[4,4,1]=0.15
T[4,4,2]=0.6
T[4,4,3]=0.15
T[4,4,4]=0.1
T[4,5,1]=0.1
T[4,5,2]=0.1
T[4,5,3]=0.7
T[4,5,4]=0.1
T[5,1,5]=1.0
T[5,2,10]=0.05
T[5,2,25]=0.025
T[5,2,27]=0.025
T[5,2,4]=0.05
T[5,2,5]=0.85
T[5,3,5]=0.1
T[5,3,6]=0.7
T[5,3,7]=0.1
T[5,3,8]=0.1
T[5,4,5]=0.1
T[5,4,6]=0.15
T[5,4,7]=0.6
T[5,4,8]=0.15
T[5,5,5]=0.1
T[5,5,6]=0.1
T[5,5,7]=0.1
T[5,5,8]=0.7
T[6,1,6]=1.0
T[6,2,10]=0.8
T[6,2,27]=0.05
T[6,2,2]=0.025
T[6,2,4]=0.025
T[6,2,6]=0.1
T[6,3,5]=0.1
T[6,3,6]=0.1
T[6,3,7]=0.7
T[6,3,8]=0.1
T[6,4,5]=0.15
T[6,4,6]=0.1
T[6,4,7]=0.15
T[6,4,8]=0.6
T[6,5,5]=0.7
T[6,5,6]=0.1
T[6,5,7]=0.1
T[6,5,8]=0.1
T[7,1,7]=1.0
T[7,2,10]=0.05
T[7,2,27]=0.8
T[7,2,4]=0.05
T[7,2,7]=0.1
T[7,3,5]=0.1
T[7,3,6]=0.1
T[7,3,7]=0.1
T[7,3,8]=0.7
T[7,4,5]=0.6
T[7,4,6]=0.15
T[7,4,7]=0.1
T[7,4,8]=0.15
T[7,5,5]=0.1
T[7,5,6]=0.7
T[7,5,7]=0.1
T[7,5,8]=0.1
T[8,1,8]=1.0
T[8,2,10]=0.025
T[8,2,12]=0.025
T[8,2,27]=0.05
T[8,2,4]=0.8
T[8,2,8]=0.1
T[8,3,5]=0.7
T[8,3,6]=0.1
T[8,3,7]=0.1
T[8,3,8]=0.1
T[8,4,5]=0.15
T[8,4,6]=0.6
T[8,4,7]=0.15
T[8,4,8]=0.1
T[8,5,5]=0.1
T[8,5,6]=0.1
T[8,5,7]=0.7
T[8,5,8]=0.1

tra = [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.5 0.0 0.0 0.0 0.5 0.0 0.0 0.0 0.0 0.0 0.0 0.0]
for a = 1 : n_a
    T[9,a,:] = tra
    T[10,a,:] = tra
    T[11,a,:] = tra
    T[12,a,:] = tra
end

T[13,1,13]=1.0
T[13,2,18]=0.05
T[13,2,29]=0.025
T[13,2,31]=0.025
T[13,2,12]=0.05
T[13,2,13]=0.85
T[13,3,13]=0.1
T[13,3,14]=0.7
T[13,3,15]=0.1
T[13,3,16]=0.1
T[13,4,13]=0.1
T[13,4,14]=0.15
T[13,4,15]=0.6
T[13,4,16]=0.15
T[13,5,13]=0.1
T[13,5,14]=0.1
T[13,5,15]=0.1
T[13,5,16]=0.7
T[14,1,14]=1.0
T[14,2,18]=0.8
T[14,2,31]=0.05
T[14,2,10]=0.025
T[14,2,12]=0.025
T[14,2,14]=0.1
T[14,3,13]=0.1
T[14,3,14]=0.1
T[14,3,15]=0.7
T[14,3,16]=0.1
T[14,4,13]=0.15
T[14,4,14]=0.1
T[14,4,15]=0.15
T[14,4,16]=0.6
T[14,5,13]=0.7
T[14,5,14]=0.1
T[14,5,15]=0.1
T[14,5,16]=0.1
T[15,1,15]=1.0
T[15,2,18]=0.05
T[15,2,31]=0.8
T[15,2,12]=0.05
T[15,2,15]=0.1
T[15,3,13]=0.1
T[15,3,14]=0.1
T[15,3,15]=0.1
T[15,3,16]=0.7
T[15,4,13]=0.6
T[15,4,14]=0.15
T[15,4,15]=0.1
T[15,4,16]=0.15
T[15,5,13]=0.1
T[15,5,14]=0.7
T[15,5,15]=0.1
T[15,5,16]=0.1
T[16,1,16]=1.0
T[16,2,18]=0.025
T[16,2,20]=0.025
T[16,2,31]=0.05
T[16,2,12]=0.8
T[16,2,16]=0.1
T[16,3,13]=0.7
T[16,3,14]=0.1
T[16,3,15]=0.1
T[16,3,16]=0.1
T[16,4,13]=0.15
T[16,4,14]=0.6
T[16,4,15]=0.15
T[16,4,16]=0.1
T[16,5,13]=0.1
T[16,5,14]=0.1
T[16,5,15]=0.7
T[16,5,16]=0.1
T[17,1,17]=1.0
T[17,2,33]=0.025
T[17,2,35]=0.025
T[17,2,16]=0.05
T[17,2,17]=0.9
T[17,3,17]=0.1
T[17,3,18]=0.7
T[17,3,19]=0.1
T[17,3,20]=0.1
T[17,4,17]=0.1
T[17,4,18]=0.15
T[17,4,19]=0.6
T[17,4,20]=0.15
T[17,5,17]=0.1
T[17,5,18]=0.1
T[17,5,19]=0.1
T[17,5,20]=0.7
T[18,1,18]=1.0
T[18,2,35]=0.05
T[18,2,14]=0.025
T[18,2,16]=0.025
T[18,2,18]=0.9
T[18,3,17]=0.1
T[18,3,18]=0.1
T[18,3,19]=0.7
T[18,3,20]=0.1
T[18,4,17]=0.15
T[18,4,18]=0.1
T[18,4,19]=0.15
T[18,4,20]=0.6
T[18,5,17]=0.7
T[18,5,18]=0.1
T[18,5,19]=0.1
T[18,5,20]=0.1
T[19,1,19]=1.0
T[19,2,35]=0.8
T[19,2,16]=0.05
T[19,2,19]=0.15
T[19,3,17]=0.1
T[19,3,18]=0.1
T[19,3,19]=0.1
T[19,3,20]=0.7
T[19,4,17]=0.6
T[19,4,18]=0.15
T[19,4,19]=0.1
T[19,4,20]=0.15
T[19,5,17]=0.1
T[19,5,18]=0.7
T[19,5,19]=0.1
T[19,5,20]=0.1
T[20,1,20]=1.0
T[20,2,35]=0.05
T[20,2,16]=0.8
T[20,2,20]=0.15
T[20,3,17]=0.7
T[20,3,18]=0.1
T[20,3,19]=0.1
T[20,3,20]=0.1
T[20,4,17]=0.15
T[20,4,18]=0.6
T[20,4,19]=0.15
T[20,4,20]=0.1
T[20,5,17]=0.1
T[20,5,18]=0.1
T[20,5,19]=0.7
T[20,5,20]=0.1
T[21,1,21]=1.0
T[21,2,1]=0.8
T[21,2,26]=0.05
T[21,2,21]=0.15
T[21,3,21]=0.1
T[21,3,22]=0.7
T[21,3,23]=0.1
T[21,3,24]=0.1
T[21,4,21]=0.1
T[21,4,22]=0.15
T[21,4,23]=0.6
T[21,4,24]=0.15
T[21,5,21]=0.1
T[21,5,22]=0.1
T[21,5,23]=0.1
T[21,5,24]=0.7
T[22,1,22]=1.0
T[22,2,1]=0.05
T[22,2,26]=0.8
T[22,2,22]=0.15
T[22,3,21]=0.1
T[22,3,22]=0.1
T[22,3,23]=0.7
T[22,3,24]=0.1
T[22,4,21]=0.15
T[22,4,22]=0.1
T[22,4,23]=0.15
T[22,4,24]=0.6
T[22,5,21]=0.7
T[22,5,22]=0.1
T[22,5,23]=0.1
T[22,5,24]=0.1
T[23,1,23]=1.0
T[23,2,1]=0.025
T[23,2,3]=0.025
T[23,2,26]=0.05
T[23,2,23]=0.9
T[23,3,21]=0.1
T[23,3,22]=0.1
T[23,3,23]=0.1
T[23,3,24]=0.7
T[23,4,21]=0.6
T[23,4,22]=0.15
T[23,4,23]=0.1
T[23,4,24]=0.15
T[23,5,21]=0.1
T[23,5,22]=0.7
T[23,5,23]=0.1
T[23,5,24]=0.1
T[24,1,24]=1.0
T[24,2,1]=0.05
T[24,2,26]=0.025
T[24,2,28]=0.025
T[24,2,24]=0.9
T[24,3,21]=0.7
T[24,3,22]=0.1
T[24,3,23]=0.1
T[24,3,24]=0.1
T[24,4,21]=0.15
T[24,4,22]=0.6
T[24,4,23]=0.15
T[24,4,24]=0.1
T[24,5,21]=0.1
T[24,5,22]=0.1
T[24,5,23]=0.7
T[24,5,24]=0.1
T[25,1,25]=1.0
T[25,2,5]=0.8
T[25,2,24]=0.05
T[25,2,25]=0.15
T[25,3,25]=0.1
T[25,3,26]=0.7
T[25,3,27]=0.1
T[25,3,28]=0.1
T[25,4,25]=0.1
T[25,4,26]=0.15
T[25,4,27]=0.6
T[25,4,28]=0.15
T[25,5,25]=0.1
T[25,5,26]=0.1
T[25,5,27]=0.1
T[25,5,28]=0.7
T[26,1,26]=1.0
T[26,2,5]=0.05
T[26,2,22]=0.025
T[26,2,24]=0.025
T[26,2,26]=0.9
T[26,3,25]=0.1
T[26,3,26]=0.1
T[26,3,27]=0.7
T[26,3,28]=0.1
T[26,4,25]=0.15
T[26,4,26]=0.1
T[26,4,27]=0.15
T[26,4,28]=0.6
T[26,5,25]=0.7
T[26,5,26]=0.1
T[26,5,27]=0.1
T[26,5,28]=0.1
T[27,1,27]=1.0
T[27,2,5]=0.025
T[27,2,7]=0.025
T[27,2,24]=0.05
T[27,2,27]=0.9
T[27,3,25]=0.1
T[27,3,26]=0.1
T[27,3,27]=0.1
T[27,3,28]=0.7
T[27,4,25]=0.6
T[27,4,26]=0.15
T[27,4,27]=0.1
T[27,4,28]=0.15
T[27,5,25]=0.1
T[27,5,26]=0.7
T[27,5,27]=0.1
T[27,5,28]=0.1
T[28,1,28]=1.0
T[28,2,5]=0.05
T[28,2,24]=0.8
T[28,2,28]=0.15
T[28,3,25]=0.7
T[28,3,26]=0.1
T[28,3,27]=0.1
T[28,3,28]=0.1
T[28,4,25]=0.15
T[28,4,26]=0.6
T[28,4,27]=0.15
T[28,4,28]=0.1
T[28,5,25]=0.1
T[28,5,26]=0.1
T[28,5,27]=0.7
T[28,5,28]=0.1
T[29,1,29]=1.0
T[29,2,13]=0.8
T[29,2,34]=0.05
T[29,2,29]=0.15
T[29,3,29]=0.1
T[29,3,30]=0.7
T[29,3,31]=0.1
T[29,3,32]=0.1
T[29,4,29]=0.1
T[29,4,30]=0.15
T[29,4,31]=0.6
T[29,4,32]=0.15
T[29,5,29]=0.1
T[29,5,30]=0.1
T[29,5,31]=0.1
T[29,5,32]=0.7
T[30,1,30]=1.0
T[30,2,13]=0.05
T[30,2,34]=0.8
T[30,2,30]=0.15
T[30,3,29]=0.1
T[30,3,30]=0.1
T[30,3,31]=0.7
T[30,3,32]=0.1
T[30,4,29]=0.15
T[30,4,30]=0.1
T[30,4,31]=0.15
T[30,4,32]=0.6
T[30,5,29]=0.7
T[30,5,30]=0.1
T[30,5,31]=0.1
T[30,5,32]=0.1
T[31,1,31]=1.0
T[31,2,13]=0.025
T[31,2,15]=0.025
T[31,2,34]=0.05
T[31,2,31]=0.9
T[31,3,29]=0.1
T[31,3,30]=0.1
T[31,3,31]=0.1
T[31,3,32]=0.7
T[31,4,29]=0.6
T[31,4,30]=0.15
T[31,4,31]=0.1
T[31,4,32]=0.15
T[31,5,29]=0.1
T[31,5,30]=0.7
T[31,5,31]=0.1
T[31,5,32]=0.1
T[32,1,32]=1.0
T[32,2,13]=0.05
T[32,2,34]=0.025
T[32,2,36]=0.025
T[32,2,32]=0.9
T[32,3,29]=0.7
T[32,3,30]=0.1
T[32,3,31]=0.1
T[32,3,32]=0.1
T[32,4,29]=0.15
T[32,4,30]=0.6
T[32,4,31]=0.15
T[32,4,32]=0.1
T[32,5,29]=0.1
T[32,5,30]=0.1
T[32,5,31]=0.7
T[32,5,32]=0.1
T[33,1,33]=1.0
T[33,2,17]=0.8
T[33,2,32]=0.05
T[33,2,33]=0.15
T[33,3,33]=0.1
T[33,3,34]=0.7
T[33,3,35]=0.1
T[33,3,36]=0.1
T[33,4,33]=0.1
T[33,4,34]=0.15
T[33,4,35]=0.6
T[33,4,36]=0.15
T[33,5,33]=0.1
T[33,5,34]=0.1
T[33,5,35]=0.1
T[33,5,36]=0.7
T[34,1,34]=1.0
T[34,2,17]=0.05
T[34,2,30]=0.025
T[34,2,32]=0.025
T[34,2,34]=0.9
T[34,3,33]=0.1
T[34,3,34]=0.1
T[34,3,35]=0.7
T[34,3,36]=0.1
T[34,4,33]=0.15
T[34,4,34]=0.1
T[34,4,35]=0.15
T[34,4,36]=0.6
T[34,5,33]=0.7
T[34,5,34]=0.1
T[34,5,35]=0.1
T[34,5,36]=0.1
T[35,1,35]=1.0
T[35,2,17]=0.025
T[35,2,19]=0.025
T[35,2,32]=0.05
T[35,2,35]=0.9
T[35,3,33]=0.1
T[35,3,34]=0.1
T[35,3,35]=0.1
T[35,3,36]=0.7
T[35,4,33]=0.6
T[35,4,34]=0.15
T[35,4,35]=0.1
T[35,4,36]=0.15
T[35,5,33]=0.1
T[35,5,34]=0.7
T[35,5,35]=0.1
T[35,5,36]=0.1
T[36,1,36]=1.0
T[36,2,17]=0.05
T[36,2,32]=0.8
T[36,2,36]=0.15
T[36,3,33]=0.7
T[36,3,34]=0.1
T[36,3,35]=0.1
T[36,3,36]=0.1
T[36,4,33]=0.15
T[36,4,34]=0.6
T[36,4,35]=0.15
T[36,4,36]=0.1
T[36,5,33]=0.1
T[36,5,34]=0.1
T[36,5,35]=0.7
T[36,5,36]=0.1

OO = zeros(Float64,n_s,n_o)
OO[1,:] = [0.009024 0.081225 0.000474 0.004275 0.000474 0.004275 0.000024 0.000225 0.081225 0.731024 0.004275 0.038475 0.004275 0.038475 0.000225 0.002030  0.0]
OO[2,:] = [0.009024 0.081225 0.081225 0.731024 0.000474 0.004275 0.004275 0.038475 0.000474 0.004275 0.004275 0.038475 0.000024 0.000225 0.000225 0.002030  0.0]
OO[3,:] = [0.009024 0.000474 0.081225 0.004275 0.081225 0.004275 0.731024 0.038475 0.000474 0.000024 0.004275 0.000225 0.004275 0.000225 0.038475 0.002030  0.0]
OO[4,:] = [0.009024 0.000474 0.000474 0.000024 0.081225 0.004275 0.004275 0.000225 0.081225 0.004275 0.004275 0.000225 0.731024 0.038475 0.038475 0.002030  0.0]
OO[5,:] = [0.085737 0.004512 0.004512 0.000237 0.004512 0.000237 0.000237 0.000012 0.771637 0.040612 0.040612 0.002137 0.040612 0.002137 0.002137 0.000120  0.0]
OO[6,:] = [0.085737 0.771637 0.004512 0.040612 0.004512 0.040612 0.000237 0.002137 0.004512 0.040612 0.000237 0.002137 0.000237 0.002137 0.000012 0.000120  0.0]
OO[7,:] = [0.085737 0.004512 0.771637 0.040612 0.004512 0.000237 0.040612 0.002137 0.004512 0.000237 0.040612 0.002137 0.000237 0.000012 0.002137 0.000120  0.0]
OO[8,:] = [0.085737 0.004512 0.004512 0.000237 0.771637 0.040612 0.040612 0.002137 0.004512 0.000237 0.000237 0.000012 0.040612 0.002137 0.002137 0.000120  0.0]
OO[9,:] = [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0]
OO[10,:] = [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0]
OO[11,:] = [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0]
OO[12,:] = [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0]
OO[13,:] = [0.085737 0.004512 0.004512 0.000237 0.004512 0.000237 0.000237 0.000012 0.771637 0.040612 0.040612 0.002137 0.040612 0.002137 0.002137 0.000120  0.0]
OO[14,:] = [0.085737 0.771637 0.004512 0.040612 0.004512 0.040612 0.000237 0.002137 0.004512 0.040612 0.000237 0.002137 0.000237 0.002137 0.000012 0.000120  0.0]
OO[15,:] = [0.085737 0.004512 0.771637 0.040612 0.004512 0.000237 0.040612 0.002137 0.004512 0.000237 0.040612 0.002137 0.000237 0.000012 0.002137 0.000120  0.0]
OO[16,:] = [0.085737 0.004512 0.004512 0.000237 0.771637 0.040612 0.040612 0.002137 0.004512 0.000237 0.000237 0.000012 0.040612 0.002137 0.002137 0.000120  0.0]
OO[17,:] = [0.009024 0.000474 0.000474 0.000024 0.081225 0.004275 0.004275 0.000225 0.081225 0.004275 0.004275 0.000225 0.731024 0.038475 0.038475 0.002030  0.0]
OO[18,:] = [0.009024 0.081225 0.000474 0.004275 0.000474 0.004275 0.000024 0.000225 0.081225 0.731024 0.004275 0.038475 0.004275 0.038475 0.000225 0.002030  0.0]
OO[19,:] = [0.009024 0.081225 0.081225 0.731024 0.000474 0.004275 0.004275 0.038475 0.000474 0.004275 0.004275 0.038475 0.000024 0.000225 0.000225 0.002030  0.0]
OO[20,:] = [0.009024 0.000474 0.081225 0.004275 0.081225 0.004275 0.731024 0.038475 0.000474 0.000024 0.004275 0.000225 0.004275 0.000225 0.038475 0.002030  0.0]
OO[21,:] = [0.009024 0.081225 0.081225 0.731024 0.000474 0.004275 0.004275 0.038475 0.000474 0.004275 0.004275 0.038475 0.000024 0.000225 0.000225 0.002030  0.0]
OO[22,:] = [0.009024 0.000474 0.081225 0.004275 0.081225 0.004275 0.731024 0.038475 0.000474 0.000024 0.004275 0.000225 0.004275 0.000225 0.038475 0.002030  0.0]
OO[23,:] = [0.009024 0.000474 0.000474 0.000024 0.081225 0.004275 0.004275 0.000225 0.081225 0.004275 0.004275 0.000225 0.731024 0.038475 0.038475 0.002030  0.0]
OO[24,:] = [0.009024 0.081225 0.000474 0.004275 0.000474 0.004275 0.000024 0.000225 0.081225 0.731024 0.004275 0.038475 0.004275 0.038475 0.000225 0.002030  0.0]
OO[25,:] = [0.009024 0.000474 0.081225 0.004275 0.081225 0.004275 0.731024 0.038475 0.000474 0.000024 0.004275 0.000225 0.004275 0.000225 0.038475 0.002030  0.0]
OO[26,:] = [0.009024 0.000474 0.000474 0.000024 0.081225 0.004275 0.004275 0.000225 0.081225 0.004275 0.004275 0.000225 0.731024 0.038475 0.038475 0.002030  0.0]
OO[27,:] = [0.009024 0.081225 0.000474 0.004275 0.000474 0.004275 0.000024 0.000225 0.081225 0.731024 0.004275 0.038475 0.004275 0.038475 0.000225 0.002030  0.0]
OO[28,:] = [0.009024 0.081225 0.081225 0.731024 0.000474 0.004275 0.004275 0.038475 0.000474 0.004275 0.004275 0.038475 0.000024 0.000225 0.000225 0.002030  0.0]
OO[29,:] = [0.009024 0.081225 0.081225 0.731024 0.000474 0.004275 0.004275 0.038475 0.000474 0.004275 0.004275 0.038475 0.000024 0.000225 0.000225 0.002030  0.0]
OO[30,:] = [0.009024 0.000474 0.081225 0.004275 0.081225 0.004275 0.731024 0.038475 0.000474 0.000024 0.004275 0.000225 0.004275 0.000225 0.038475 0.002030  0.0]
OO[31,:] = [0.009024 0.000474 0.000474 0.000024 0.081225 0.004275 0.004275 0.000225 0.081225 0.004275 0.004275 0.000225 0.731024 0.038475 0.038475 0.002030  0.0]
OO[32,:] = [0.009024 0.081225 0.000474 0.004275 0.000474 0.004275 0.000024 0.000225 0.081225 0.731024 0.004275 0.038475 0.004275 0.038475 0.000225 0.002030  0.0]
OO[33,:] = [0.009024 0.000474 0.081225 0.004275 0.081225 0.004275 0.731024 0.038475 0.000474 0.000024 0.004275 0.000225 0.004275 0.000225 0.038475 0.002030  0.0]
OO[34,:] = [0.009024 0.000474 0.000474 0.000024 0.081225 0.004275 0.004275 0.000225 0.081225 0.004275 0.004275 0.000225 0.731024 0.038475 0.038475 0.002030  0.0]
OO[35,:] = [0.009024 0.081225 0.000474 0.004275 0.000474 0.004275 0.000024 0.000225 0.081225 0.731024 0.004275 0.038475 0.004275 0.038475 0.000225 0.002030  0.0]
OO[36,:] = [0.009024 0.081225 0.081225 0.731024 0.000474 0.004275 0.004275 0.038475 0.000474 0.004275 0.004275 0.038475 0.000024 0.000225 0.000225 0.002030  0.0]

for s = 1 : n_s
    for a = 1 : n_a
        for o = 1 : n_o
            O[s,a,o] = OO[s,o]
        end
    end
end

for s = 1 : n_s
    for a = 1 : n_a
        R[s,a,1] = -1.0
        R[s,a,2] = -1.0
        R[s,a,3] = -1.0
        R[s,a,4] = -1.0
        R[s,a,9] = 1.0
        R[s,a,10] = 1.0
        R[s,a,11] = 1.0
        R[s,a,12] = 1.0
        R[s,a,17] = -1.0
        R[s,a,18] = -1.0
        R[s,a,19] = -1.0
        R[s,a,20] = -1.0
    end
end

################################

function one_tiger_grid_trial(T,R,O,t_step,alpha,gamma)
    (n_s,n_a,n_o) = (size(T)[1],size(T)[2],size(O)[3])

    # initial belief
    b = zeros(Float64,n_s)
    b[25] = 0.5
    b[29] = 0.5

    # Initialize state
    if rand() < 0.5
        x = 25
    else
        x = 29
    end

    # intialize total reward
    total_r = 0

    for t = 1 : t_step

        # Choose the action
        action_to_do = action_to_take(b,alpha)

        # Get reward and the next state
        (xp,r) = tran_reward_sampling(T,R,x,action_to_do)
        total_r += r *  ((gamma)^t)

        # Get observation
        o = observe_sampling(O,xp,action_to_do)

        # update the belief
        bp = belief_update(b,action_to_do,o,T,O)

        # printing
        #println("Time Step = ",t)
        #println("S,A,O,R,SP",(x,action_to_do,o,r,xp))

        # update
        b = bp
        x = xp

    end

    return (total_r)

end

function one_tiger_grid_trial_2(T,R,O,t_step,alpha,gamma)
    (n_s,n_a,n_o) = (size(T)[1],size(T)[2],size(O)[3])

    # initial belief
    b = ones(Float64,n_s) * (1/n_s)

    # Initialize state
    x = round(Int64,div(rand()*n_s,1)) + 1

    # intialize total reward
    total_r = 0

    for t = 1 : t_step

        # Choose the action
        action_to_do = action_to_take(b,alpha)

        # Get reward and the next state
        (xp,r) = tran_reward_sampling(T,R,x,action_to_do)
        total_r += r *  ((gamma)^t)

        # Get observation
        o = observe_sampling(O,xp,action_to_do)

        # update the belief
        bp = belief_update(b,action_to_do,o,T,O)

        # printing
        #println("Time Step = ",t)
        #println("S,A,O,R,SP",(x,action_to_do,o,r,xp))

        # update
        b = bp
        x = xp

    end

    return (total_r)

end

######################################################

#gamma = 0.95

#@time Q_MDP = Q_value_iteration(zeros(Float64,n_s,n_a),T,R,0.01,gamma)
#@time Q_UMDP = QUMDP(zeros(Float64,n_s,n_a),T,R,0.01,gamma/1.1)
#@time Q_FIB = FIB(zeros(Float64,n_s,n_a),T,R,O,0.01,gamma/1.3)
#@time Q_M3 = purely_iteration_v3(zeros(Float64,n_s,n_a),T,R,O,0.01,gamma)
#@time Q_M5 = purely_iteration_v5(zeros(Float64,n_s,n_a),T,R,O,0.01,gamma)
#@time Q_M6 = purely_iteration_v6(zeros(Float64,n_s,n_a),T,R,O,0.01,gamma)
#@time Q_M7 = purely_iteration_v7(zeros(Float64,n_s,n_a),T,R,O,0.01,gamma)

#QMDP_r_sum = 0
#QUMDP_r_sum = 0
#FIB_r_sum = 0
#MY_3_r_sum = 0
#MY_5_r_sum = 0
#MY_6_r_sum = 0
#MY_7_r_sum = 0
#t_trial = 1000
#t_step = 200

#for i = 1 : t_trial
#    if (i%100 == 0); println("trial = ",i); end
#    QMDP_r_sum += one_tiger_grid_trial_2(T,R,O,t_step,Q_MDP,gamma)
#    QUMDP_r_sum += one_tiger_grid_trial_2(T,R,O,t_step,Q_UMDP,gamma)
#    FIB_r_sum += one_tiger_grid_trial_2(T,R,O,t_step,Q_FIB,gamma)
    #MY_3_r_sum += one_tiger_grid_trial_2(T,R,O,t_step,Q_M3,gamma)
    #MY_5_r_sum += one_tiger_grid_trial_2(T,R,O,t_step,Q_M5,gamma)
    #MY_6_r_sum += one_tiger_grid_trial_2(T,R,O,t_step,Q_M6,gamma)
    #MY_7_r_sum += one_tiger_grid_trial_2(T,R,O,t_step,Q_M7,gamma)
#end

#println(QMDP_r_sum/t_trial)
#println(QUMDP_r_sum/t_trial)
#println(FIB_r_sum/t_trial)
#println(MY_3_r_sum/t_trial)
#println(MY_5_r_sum/t_trial)
#println(MY_6_r_sum/t_trial)
#println(MY_7_r_sum/t_trial)

gamma = 0.95
grid = 5

red = zeros(Float64,grid+1)
QMDP_r = zeros(Float64,grid+1)
UMDP_r = zeros(Float64,grid+1)
FIB_r = zeros(Float64,grid+1)


for reduced_time = 1 : grid+1

    println(reduced_time)

    redu_f = 1 + 0.2 * (reduced_time - 1)


    QMDP_alpha = Q_value_iteration(zeros(Float64,n_s,n_a),T,R,0.01,gamma/redu_f)
    QUMDP_alpha = QUMDP(zeros(Float64,n_s,n_a),T,R,0.01,gamma/redu_f)
    FIB_alpha = FIB(zeros(Float64,n_s,n_a),T,R,O,0.01,gamma/redu_f)

    #println(QMDP_alpha)

    QMDP_r_sum = 0
    QUMDP_r_sum = 0
    FIB_r_sum = 0

    t_trial = 2000
    t_step = 200

    for i = 1 : t_trial

        QMDP_r_sum += one_tiger_grid_trial_2(T,R,O,t_step,QMDP_alpha,gamma)
        QUMDP_r_sum += one_tiger_grid_trial_2(T,R,O,t_step,QUMDP_alpha,gamma)
        FIB_r_sum += one_tiger_grid_trial_2(T,R,O,t_step,FIB_alpha,gamma)

    end

    red[reduced_time] = redu_f
    QMDP_r[reduced_time] = QMDP_r_sum/t_trial
    UMDP_r[reduced_time] = QUMDP_r_sum/t_trial
    FIB_r[reduced_time] = FIB_r_sum/t_trial

end

plot(red,QMDP_r,label="QMDP")
plot(red,UMDP_r,label="UMDP")
plot(red,FIB_r,label="FIB")
xlabel("reduced factor")
ylabel("Discounted Reward")
title("Tiger grid with gamma 0.95 and concentrated initial belief")
legend(loc="upper right",fancybox="true")
#annotate("SARSOP = 2.309",
#	xy=[1;0],
#	xycoords="axes fraction",
#	xytext=[-10,10],
#	textcoords="offset points",
#	fontsize=12.0,
#	ha="right",
#	va="bottom")
